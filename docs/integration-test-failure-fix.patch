From a0b6e32f0c86313d6d2feccfde7e263dc6c88933 Mon Sep 17 00:00:00 2001
From: GitHub Actions <github-actions[bot]@users.noreply.github.com>
Date: Thu, 1 Jan 2026 05:07:51 +0000
Subject: [PATCH] fix: auto-format and lint test files

- Run black to format 4 test files
- Run ruff --fix to remove unused imports and fix whitespace

This fixes the CI failures reported in stranske/Workflows#<issue_number>

Files fixed:
- tests/test_resolve_mypy_pin.py
- tests/test_script_execution.py
- tests/test_sync_test_dependencies.py
- tests/test_sync_tool_versions.py
---
 tests/test_resolve_mypy_pin.py       | 39 ++++++++++++++--------------
 tests/test_script_execution.py       |  7 ++---
 tests/test_sync_test_dependencies.py | 32 +++++++++++------------
 tests/test_sync_tool_versions.py     | 31 +++++++++++-----------
 4 files changed, 55 insertions(+), 54 deletions(-)

diff --git a/tests/test_resolve_mypy_pin.py b/tests/test_resolve_mypy_pin.py
index 4bf74ae..ce5a333 100644
--- a/tests/test_resolve_mypy_pin.py
+++ b/tests/test_resolve_mypy_pin.py
@@ -1,7 +1,6 @@
 """Tests for tools/resolve_mypy_pin.py."""
-import os
+
 import sys
-import tempfile
 from io import StringIO
 from pathlib import Path
 
@@ -13,14 +12,14 @@ def test_main_with_github_output(monkeypatch: pytest.MonkeyPatch, tmp_path: Path
     output_file = tmp_path / "github_output.txt"
     monkeypatch.setenv("GITHUB_OUTPUT", str(output_file))
     monkeypatch.setenv("MATRIX_PYTHON_VERSION", "3.12")
-    
+
     from tools.resolve_mypy_pin import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert output_file.exists()
     content = output_file.read_text()
@@ -32,14 +31,14 @@ def test_main_without_github_output(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test script works locally without GITHUB_OUTPUT."""
     monkeypatch.delenv("GITHUB_OUTPUT", raising=False)
     monkeypatch.setenv("MATRIX_PYTHON_VERSION", "3.11")
-    
+
     from tools.resolve_mypy_pin import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert "python-version=3.11" in captured_output.getvalue()
 
@@ -48,14 +47,14 @@ def test_main_defaults_to_311(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test script uses 3.11 as default when MATRIX_PYTHON_VERSION not set."""
     monkeypatch.delenv("MATRIX_PYTHON_VERSION", raising=False)
     monkeypatch.delenv("GITHUB_OUTPUT", raising=False)
-    
+
     from tools.resolve_mypy_pin import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert "python-version=3.11" in captured_output.getvalue()
 
@@ -65,11 +64,11 @@ def test_main_with_custom_version(monkeypatch: pytest.MonkeyPatch, tmp_path: Pat
     output_file = tmp_path / "output.txt"
     monkeypatch.setenv("GITHUB_OUTPUT", str(output_file))
     monkeypatch.setenv("MATRIX_PYTHON_VERSION", "3.13")
-    
+
     from tools.resolve_mypy_pin import main
-    
+
     result = main()
-    
+
     assert result == 0
     content = output_file.read_text()
     assert "python-version=3.13" in content
@@ -78,13 +77,13 @@ def test_main_with_custom_version(monkeypatch: pytest.MonkeyPatch, tmp_path: Pat
 def test_main_via_command_line(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test running main via command line invocation."""
     import tools.resolve_mypy_pin
-    
+
     monkeypatch.delenv("GITHUB_OUTPUT", raising=False)
     monkeypatch.setenv("MATRIX_PYTHON_VERSION", "3.12")
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = tools.resolve_mypy_pin.main()
-    
+
     assert result == 0
     assert "python-version=3.12" in captured_output.getvalue()
diff --git a/tests/test_script_execution.py b/tests/test_script_execution.py
index 36c8496..cae0dcb 100644
--- a/tests/test_script_execution.py
+++ b/tests/test_script_execution.py
@@ -1,4 +1,5 @@
 """Tests for script execution as __main__."""
+
 import subprocess
 import sys
 from pathlib import Path
@@ -12,7 +13,7 @@ def test_sync_test_dependencies_as_script() -> None:
         text=True,
         cwd=Path(__file__).parent.parent,
     )
-    
+
     assert result.returncode == 0
     assert "✅" in result.stdout
 
@@ -25,7 +26,7 @@ def test_sync_tool_versions_as_script() -> None:
         text=True,
         cwd=Path(__file__).parent.parent,
     )
-    
+
     assert result.returncode == 0
     assert "✅" in result.stdout
 
@@ -39,6 +40,6 @@ def test_resolve_mypy_pin_as_script() -> None:
         env={"MATRIX_PYTHON_VERSION": "3.11"},
         cwd=Path(__file__).parent.parent,
     )
-    
+
     assert result.returncode == 0
     assert "python-version=3.11" in result.stdout
diff --git a/tests/test_sync_test_dependencies.py b/tests/test_sync_test_dependencies.py
index c7bd2b6..8272c9f 100644
--- a/tests/test_sync_test_dependencies.py
+++ b/tests/test_sync_test_dependencies.py
@@ -1,7 +1,7 @@
 """Tests for scripts/sync_test_dependencies.py."""
+
 import sys
 from io import StringIO
-from pathlib import Path
 
 import pytest
 
@@ -9,15 +9,15 @@ import pytest
 def test_main_success_verify(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test verify mode returns success."""
     monkeypatch.setattr(sys, "argv", ["sync_test_dependencies.py", "--verify"])
-    
+
     # Import after argv is set
     from scripts.sync_test_dependencies import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert "✅" in captured_output.getvalue()
     assert "All test dependencies" in captured_output.getvalue()
@@ -26,14 +26,14 @@ def test_main_success_verify(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_success_fix(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test fix mode returns success."""
     monkeypatch.setattr(sys, "argv", ["sync_test_dependencies.py", "--fix"])
-    
+
     from scripts.sync_test_dependencies import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert "✅" in captured_output.getvalue()
 
@@ -41,9 +41,9 @@ def test_main_success_fix(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_no_args(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test script runs successfully with no arguments."""
     monkeypatch.setattr(sys, "argv", ["sync_test_dependencies.py"])
-    
+
     from scripts.sync_test_dependencies import main
-    
+
     result = main()
     assert result == 0
 
@@ -51,9 +51,9 @@ def test_main_no_args(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_both_flags(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test script handles both --fix and --verify flags."""
     monkeypatch.setattr(sys, "argv", ["sync_test_dependencies.py", "--fix", "--verify"])
-    
+
     from scripts.sync_test_dependencies import main
-    
+
     result = main()
     assert result == 0
 
@@ -61,13 +61,13 @@ def test_main_both_flags(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_via_command_line(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test running main via command line invocation."""
     import scripts.sync_test_dependencies
-    
+
     monkeypatch.setattr(sys, "argv", ["sync_test_dependencies.py", "--verify"])
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     # Simulate running as __main__
     result = scripts.sync_test_dependencies.main()
-    
+
     assert result == 0
     assert "✅" in captured_output.getvalue()
diff --git a/tests/test_sync_tool_versions.py b/tests/test_sync_tool_versions.py
index 110894b..2bfa894 100644
--- a/tests/test_sync_tool_versions.py
+++ b/tests/test_sync_tool_versions.py
@@ -1,4 +1,5 @@
 """Tests for scripts/sync_tool_versions.py."""
+
 import sys
 from io import StringIO
 
@@ -8,14 +9,14 @@ import pytest
 def test_main_success_check(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test check mode returns success."""
     monkeypatch.setattr(sys, "argv", ["sync_tool_versions.py", "--check"])
-    
+
     from scripts.sync_tool_versions import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert "✅" in captured_output.getvalue()
     assert "Tool versions are aligned" in captured_output.getvalue()
@@ -24,14 +25,14 @@ def test_main_success_check(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_success_apply(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test apply mode returns success."""
     monkeypatch.setattr(sys, "argv", ["sync_tool_versions.py", "--apply"])
-    
+
     from scripts.sync_tool_versions import main
-    
+
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = main()
-    
+
     assert result == 0
     assert "✅" in captured_output.getvalue()
 
@@ -39,9 +40,9 @@ def test_main_success_apply(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_no_args(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test script runs successfully with no arguments."""
     monkeypatch.setattr(sys, "argv", ["sync_tool_versions.py"])
-    
+
     from scripts.sync_tool_versions import main
-    
+
     result = main()
     assert result == 0
 
@@ -49,9 +50,9 @@ def test_main_no_args(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_both_flags(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test script handles both --check and --apply flags."""
     monkeypatch.setattr(sys, "argv", ["sync_tool_versions.py", "--check", "--apply"])
-    
+
     from scripts.sync_tool_versions import main
-    
+
     result = main()
     assert result == 0
 
@@ -59,12 +60,12 @@ def test_main_both_flags(monkeypatch: pytest.MonkeyPatch) -> None:
 def test_main_via_command_line(monkeypatch: pytest.MonkeyPatch) -> None:
     """Test running main via command line invocation."""
     import scripts.sync_tool_versions
-    
+
     monkeypatch.setattr(sys, "argv", ["sync_tool_versions.py", "--check"])
     captured_output = StringIO()
     monkeypatch.setattr(sys, "stdout", captured_output)
-    
+
     result = scripts.sync_tool_versions.main()
-    
+
     assert result == 0
     assert "✅" in captured_output.getvalue()
-- 
2.52.0

